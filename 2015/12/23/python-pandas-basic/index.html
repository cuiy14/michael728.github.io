<!DOCTYPE html>
<html lang="zh">
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.4 -->

    <!-- Title -->
    
    <title>
        
            Python数据分析入门之pandas总结基础 | 
        
        Michael翔的小窝
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
        <link rel="dns-prefetch" href="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"/>
    
    
    
    
    
        <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Michael_翔">
    <meta name="description" content="因上努力，果上随缘;爱折腾app、小众软件--Michael翔">
    <meta name="keywords" content="null,python,pandas,数据分析">

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" sizes="192x192" href="/img/favicon.ico">
    <link rel="apple-touch-icon" href="/img/favicon.ico">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Michael翔的小窝">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://michael728.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Python数据分析入门之pandas总结基础 | Michael翔的小窝">
    <meta property="og:description" content="因上努力，果上随缘;爱折腾app、小众软件--Michael翔">
    <meta property="og:article:tag" content="python"> <meta property="og:article:tag" content="pandas"> <meta property="og:article:tag" content="数据分析"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg_big2.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Pandas–“大熊猫”基础"><span class="post-toc-number">1.</span> <span class="post-toc-text">Pandas–“大熊猫”基础</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Series"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Series</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Series⽀持过滤的原理就如同NumPy"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">Series⽀持过滤的原理就如同NumPy</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#当然也支持广播Broadcasting"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">当然也支持广播Broadcasting</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#以及Universal-Function"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">以及Universal Function</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从Key不重复的Ordered-Dict或者从Dict来定义Series就不需要担心行索引重复："><span class="post-toc-number">1.1.5.</span> <span class="post-toc-text">从Key不重复的Ordered Dict或者从Dict来定义Series就不需要担心行索引重复：</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DataFrame"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">DataFrame</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从另一个DataFrame定义DataFrame：啊，强迫症犯了！"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">从另一个DataFrame定义DataFrame：啊，强迫症犯了！</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从DataFrame中取出列？两种方法（与JavaScript完全一致！）"><span class="post-toc-number">1.2.4.</span> <span class="post-toc-text">从DataFrame中取出列？两种方法（与JavaScript完全一致！）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从DataFrame中取出行？（至少）两种⽅法："><span class="post-toc-number">1.2.5.</span> <span class="post-toc-text">从DataFrame中取出行？（至少）两种⽅法：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#动态增加列列，但是无法用”-”的方式，只能用”-”"><span class="post-toc-number">1.2.6.</span> <span class="post-toc-text">动态增加列列，但是无法用”.”的方式，只能用”[]”</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Index：行级索引"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Index：行级索引</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#直接定义普通索引，长得就和普通的Series⼀样"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">直接定义普通索引，长得就和普通的Series⼀样</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#扔进去一个含有多元组的List，就有了MultiIndex"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">扔进去一个含有多元组的List，就有了MultiIndex</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#对于Series来说，如果拥有了多重Index，数据，变形！"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">对于Series来说，如果拥有了多重Index，数据，变形！</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#二重MultiIndex的Series可以unstack-成DataFrame"><span class="post-toc-number">1.3.3.1.</span> <span class="post-toc-text">二重MultiIndex的Series可以unstack()成DataFrame</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#DataFrame可以stack成拥有⼆重MultiIndex的Series"><span class="post-toc-number">1.3.3.2.</span> <span class="post-toc-text">DataFrame可以stack成拥有⼆重MultiIndex的Series</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#非平衡数据的例子："><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">非平衡数据的例子：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DateTime标准库如此好⽤，你值得拥有"><span class="post-toc-number">1.3.5.</span> <span class="post-toc-text">DateTime标准库如此好⽤，你值得拥有</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#如果你不仅需要时间格式统一，时间频率也要统一的话"><span class="post-toc-number">1.3.5.1.</span> <span class="post-toc-text">如果你不仅需要时间格式统一，时间频率也要统一的话</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#月级精度和日级精度如何转换？"><span class="post-toc-number">1.3.5.2.</span> <span class="post-toc-text">月级精度和日级精度如何转换？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#最后的最后，我要真正把两种频率的时间精度匹配上？"><span class="post-toc-number">1.3.5.3.</span> <span class="post-toc-text">最后的最后，我要真正把两种频率的时间精度匹配上？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#粗粒度数据＋reindex＋ffill-bfill"><span class="post-toc-number">1.3.5.4.</span> <span class="post-toc-text">粗粒度数据＋reindex＋ffill/bfill</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#关于索引，⽅便的操作有？"><span class="post-toc-number">1.3.6.</span> <span class="post-toc-text">关于索引，⽅便的操作有？</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#大熊猫世界来去自如：Pandas的I-O"><span class="post-toc-number">2.</span> <span class="post-toc-text">大熊猫世界来去自如：Pandas的I/O</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#结构化数据输入输出"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">结构化数据输入输出</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Excel-…"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Excel … ?</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#半结构化数据"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">半结构化数据</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#深入Pandas数据操纵"><span class="post-toc-number">3.</span> <span class="post-toc-text">深入Pandas数据操纵</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据集整合"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">数据集整合</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#横向拼接：直接DataFrame"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">横向拼接：直接DataFrame</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#横向拼接：Concatenate"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">横向拼接：Concatenate</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#纵向拼接：Merge"><span class="post-toc-number">3.1.3.</span> <span class="post-toc-text">纵向拼接：Merge</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#自定义函数映射"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">自定义函数映射</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#map-以相同规则将1列数据作1个映射，也就是进行相同函数的处理"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">map: 以相同规则将1列数据作1个映射，也就是进行相同函数的处理</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#排序"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">排序</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sort"><span class="post-toc-number">3.3.1.</span> <span class="post-toc-text">sort</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sort-index"><span class="post-toc-number">3.3.2.</span> <span class="post-toc-text">sort_index</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#一个好用的功能：Rank"><span class="post-toc-number">3.3.3.</span> <span class="post-toc-text">一个好用的功能：Rank</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#缺失数据处理"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">缺失数据处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#忽略缺失值："><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">忽略缺失值：</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#“一组”大熊猫：Pandas的groupby"><span class="post-toc-number">4.</span> <span class="post-toc-text">“一组”大熊猫：Pandas的groupby</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考："><span class="post-toc-number">5.</span> <span class="post-toc-text">参考：</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(https://www.enthought.com/images/pandas_logo.png)">
    
            <p class="article-headline-p">
                Python数据分析入门之pandas总结基础
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/side_logo.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Michael_翔</strong>
        <span>12月 23, 2015</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">在其它设备中阅读本文章</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC2klEQVR42u3awU4jMRAEUP7/p3evK0WbVHUPkIzfnBAExs8HSu7y158jny9sbGxsbGxsbGzst2R/xc+/n3/+9ePff3xX8tcePz9bMzY2NvYJ7Bf/+p+++PlCW9hmi1+sGRsbG/sAdrKUZDtmYfO/4NlvHzY2NjZ2cpwojgRPv5/EFTY2Njb2tez8uJIfZvKYxMbGxsZuBzTtwGgTXe1nvnGWho2Njf327GuL3p/5+u36bWxsbOxfYtdXGBehlZcBeVAVK8fGxsa+Kbu9NDkbOc0GT89HUUkJgY2NjX0Oe3/9sf1kNNAva+MXm46NjY19U3ZboLaA/HdnUVoUBtjY2Ng3Ze+vOeY/ndW3+fipzm1sbGzsW7A3g5vkSDN7ZtXCqujFxsbG/nB2W7tueMkwaxZd9QkMGxsb+0bs/MWbujdhz+qEaIOwsbGxb81ui4H86NLWA9duBDY2NvaZ7Pbgsblk066kjVVsbGzsE9ibuGqL3jpyFkGIjY2NfQ67HS3lV3M20ZVsU7JybGxs7DPZ+RI3Y6Nk4/JqIVozNjY29k3Zs2sx1w6hkvhJgq0IMGxsbOwbsTev3yylvXyZ1wnY2NjYp7E3l2Zm25FHYFsnD3MbGxsb+xbsZHDTlrWzi5h5RNXXPbGxsbFvyp4N9GcHg9l1n03QYmNjY5/AboMqiajZqOg7NhobGxv7BHYbMPlwv/3+VVuPjY2NfTI7WdbwlXGdsDl+YGNjY5/J3hw52lFRUi1syoAX9TA2Njb2Tdntk1++ya/sXHXUuSC3sbGxsT+Q3da6s9H//vOz2MPGxsY+h92GVnIIaeNwVugWlTA2Njb2Aew2tJJQSWqGfIMunqVhY2NjH8leHQbKjbi2WsbGxsbGThY0O1TkgTc7rmBjY2Ofw54Nldqaoa0i8s390VkaNjY29puxZ0tpa4BZkTB7S3HnFBsbG/vD2ec82NjY2NjY2NjY2G/z/AV7fHvujgg85AAAAABJRU5ErkJggg==">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/pandas/">pandas</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/python/">python</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/数据分析/">数据分析</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2015/12/23/python-pandas-basic/" class="leancloud-views_num" data-flag-title="Python数据分析入门之pandas总结基础">
     &nbsp;浏览量
</span>

            </li>
        </a>
    

    
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Python数据分析入门之pandas总结基础&url=http://michael728.github.io//2015/12/23/python-pandas-basic/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Python数据分析入门之pandas总结基础&url=http://michael728.github.io//2015/12/23/python-pandas-basic/index.html&via=Michael_翔" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Michael翔的小窝&title=Python数据分析入门之pandas总结基础&summary=因上努力，果上随缘;爱折腾app、小众软件--Michael翔&pics=http://michael728.github.io/img/favicon.ico&url=http://michael728.github.io/2015/12/23/python-pandas-basic/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="Pandas–“大熊猫”基础"><a href="#Pandas–“大熊猫”基础" class="headerlink" title="Pandas–“大熊猫”基础"></a>Pandas–“大熊猫”基础</h1><h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><p>Series: pandas的长枪(数据表中的一列或一行,观测向量,一维数组…)</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series1 = pd.Series(<span class="built_in">np</span>.<span class="built_in">random</span>.randn(<span class="number">4</span>))</div><div class="line"></div><div class="line"><span class="built_in">print</span> Series1,type(Series1) </div><div class="line"></div><div class="line"><span class="built_in">print</span> Series1.index</div><div class="line"></div><div class="line"><span class="built_in">print</span> Series1.<span class="built_in">values</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>输出结果：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="number">0</span>   -<span class="number">0.676256</span></div><div class="line"></div><div class="line"><span class="number">1</span>    <span class="number">0.533014</span></div><div class="line"></div><div class="line"><span class="number">2</span>   -<span class="number">0.935212</span></div><div class="line"></div><div class="line"><span class="number">3</span>   -<span class="number">0.940822</span></div><div class="line"></div><div class="line">dtype: float64 &lt;class 'pandas.core.series.Series'&gt;</div><div class="line"></div><div class="line">Int64Index([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype='int64')</div><div class="line"></div><div class="line">[-<span class="number">0.67625578</span>  <span class="number">0.53301431</span> -<span class="number">0.93521212</span> -<span class="number">0.94082195</span>]</div></pre></td></tr></table></figure>
<ul>
<li>np.random.randn()   正态分布相关。<a href="http://docs.scipy.org/doc/numpy-1.10.1/reference/generated/numpy.random.rand.html#numpy.random.rand" target="_blank" rel="external">函数说明</a></li>
</ul>
<h3 id="Series⽀持过滤的原理就如同NumPy"><a href="#Series⽀持过滤的原理就如同NumPy" class="headerlink" title="Series⽀持过滤的原理就如同NumPy"></a>Series⽀持过滤的原理就如同NumPy</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> Series1&gt;<span class="number">0</span> </div><div class="line"></div><div class="line"><span class="built_in">print</span> Series1[Series1&gt;<span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="number">0</span> <span class="number">0.030480</span></div><div class="line"></div><div class="line"><span class="number">1</span> <span class="number">0.072746</span></div><div class="line"></div><div class="line"><span class="number">2</span> -<span class="number">0.186607</span></div><div class="line"></div><div class="line"><span class="number">3</span> -<span class="number">1.412244</span></div><div class="line"></div><div class="line">dtype: float64 &lt;class 'pandas.core.series.Series'&gt;</div><div class="line"></div><div class="line">Int64Index([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype='int64')</div><div class="line"></div><div class="line">[ <span class="number">0.03048042</span> <span class="number">0.07274621</span> -<span class="number">0.18660749</span> -<span class="number">1.41224432</span>]</div></pre></td></tr></table></figure>
<p>我发现，逻辑表达式，获得的值就是True或者False。要先取得值，还是要X[y]的形式。</p>
<h3 id="当然也支持广播Broadcasting"><a href="#当然也支持广播Broadcasting" class="headerlink" title="当然也支持广播Broadcasting"></a>当然也支持广播Broadcasting</h3><p>什么是<code>broadcasting</code>,暂时我也不太清楚，看个栗子：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> Series1*<span class="number">2</span> </div><div class="line"></div><div class="line"><span class="built_in">print</span> Series1+<span class="number">5</span></div></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">0 0<span class="selector-class">.06096</span></div><div class="line"></div><div class="line">1 1 0<span class="selector-class">.145492</span> </div><div class="line"></div><div class="line">2 <span class="selector-tag">-0</span><span class="selector-class">.373215</span> </div><div class="line"></div><div class="line">3 <span class="selector-tag">-2</span><span class="selector-class">.824489</span> </div><div class="line"></div><div class="line"><span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span> </div><div class="line"></div><div class="line">0 5<span class="selector-class">.030480</span> </div><div class="line"></div><div class="line">1 5<span class="selector-class">.072746</span> </div><div class="line"></div><div class="line">2 4<span class="selector-class">.813393</span> </div><div class="line"></div><div class="line">3 3<span class="selector-class">.587756</span> </div><div class="line"></div><div class="line"><span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure>
<h3 id="以及Universal-Function"><a href="#以及Universal-Function" class="headerlink" title="以及Universal Function"></a>以及Universal Function</h3><p>numpy.frompyfunc(out,nin,nout)    返回的是一个函数，nin是输入的参数个数，nout是函数返回的对象的个数<a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.frompyfunc.html#numpy.frompyfunc" target="_blank" rel="external">函数说明</a></p>
<h3 id="在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据"><a href="#在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据" class="headerlink" title="在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据"></a>在序列上就使用行标，而不是创建1个2列的数据表，能够轻松辨别哪是数据，哪是元数据</h3><p>这句话的意思，我的理解是序列尽量是一列，不用去创建2列，这样子，使用index就能指定数据了</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series2 = pd.Series(Series1.<span class="built_in">values</span>,<span class="built_in">index</span>=[<span class="string">'norm_'</span>+unicode(i) <span class="keyword">for</span> i in xrange(<span class="number">4</span>)])</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series2,<span class="built_in">type</span>(Series2)</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series2.<span class="built_in">index</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="built_in">type</span>(Series2.<span class="built_in">index</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series2.<span class="built_in">values</span></div></pre></td></tr></table></figure>
<p>输出结果如下，可以看到，它是通过修改了<code>index</code>值的样式，并没有创建2列。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">norm_0   -<span class="number">0.676256</span></div><div class="line"></div><div class="line">norm_1    <span class="number">0.533014</span></div><div class="line"></div><div class="line">norm_2   -<span class="number">0.935212</span></div><div class="line"></div><div class="line">norm_3   -<span class="number">0.940822</span></div><div class="line"></div><div class="line">dtype: float64 &lt;class <span class="string">'pandas.core.series.Series'</span>&gt;</div><div class="line"></div><div class="line">Index([<span class="string">u'norm_0'</span>, <span class="string">u'norm_1'</span>, <span class="string">u'norm_2'</span>, <span class="string">u'norm_3'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">&lt;class <span class="string">'pandas.core.index.Index'</span>&gt;</div><div class="line"></div><div class="line">[-<span class="number">0.67625578</span>  <span class="number">0.53301431</span> -<span class="number">0.93521212</span> -<span class="number">0.94082195</span>]</div></pre></td></tr></table></figure>
<p>虽然行是有顺序的，但是仍然能够通过行级的index来访问到数据：</p>
<p>（当然也不尽然像Ordered Dict，因为⾏索引甚⾄可以重复，不推荐重复的行索引不代表不能用）</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> Series2<span class="string">[['norm_0','norm_3']]</span></div></pre></td></tr></table></figure>
<p>可以看到，读取数据时，确实要采用X[y]的格式。这里X[[y]]是因为，它要读取两个数据，指定的是这两个数据的<code>index</code>值，将<code>index</code>值存放进<code>list</code>中，然后读取。输出结果如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="selector-tag">norm_0</span>   <span class="selector-tag">-0</span><span class="selector-class">.676256</span></div><div class="line"></div><div class="line"><span class="selector-tag">norm_3</span>   <span class="selector-tag">-0</span><span class="selector-class">.940822</span></div><div class="line"></div><div class="line"><span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure>
<p>再比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> <span class="string">'norm_0'</span> <span class="keyword">in</span> Series2</div><div class="line"></div><div class="line"><span class="built_in">print</span> <span class="string">'norm_6'</span> <span class="keyword">in</span> Series2</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="literal">True</span></div><div class="line"></div><div class="line"><span class="literal">False</span></div></pre></td></tr></table></figure>
<p>逻辑表达式的输出结果，布尔型值。</p>
<h3 id="从Key不重复的Ordered-Dict或者从Dict来定义Series就不需要担心行索引重复："><a href="#从Key不重复的Ordered-Dict或者从Dict来定义Series就不需要担心行索引重复：" class="headerlink" title="从Key不重复的Ordered Dict或者从Dict来定义Series就不需要担心行索引重复："></a>从Key不重复的Ordered Dict或者从Dict来定义Series就不需要担心行索引重复：</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series3_Dict = &#123;<span class="string">"Japan"</span>:<span class="string">"Tokyo"</span>,<span class="string">"S.Korea"</span>:<span class="string">"Seoul"</span>,<span class="string">"China"</span>:<span class="string">"Beijing"</span>&#125;</div><div class="line"></div><div class="line">Series3_pdSeries = pd.Series(Series3_Dict)</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series3_pdSeries</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series3_pdSeries.<span class="built_in">values</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> Series3_pdSeries.<span class="built_in">index</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">China Beijing</div><div class="line"></div><div class="line">Japan Tokyo</div><div class="line"></div><div class="line">S.Korea Seoul</div><div class="line"></div><div class="line">dtype: object</div><div class="line"></div><div class="line">[<span class="string">'Beijing'</span> <span class="string">'Tokyo'</span> <span class="string">'Seoul'</span>]</div><div class="line"></div><div class="line">Index([<span class="string">u'China'</span>, <span class="string">u'Japan'</span>, <span class="string">u'S.Korea'</span>], dtype=<span class="string">'object'</span>)</div></pre></td></tr></table></figure>
<p>通过上面的输出结果就知道了，输出结果是无序的，和输入顺序无关。 </p>
<p>想让序列按你的排序⽅式保存？就算有缺失值都毫无问题</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series4_IndexList = [<span class="string">"Japan"</span>,<span class="string">"China"</span>,<span class="string">"Singapore"</span>,<span class="string">"S.Korea"</span>]</div><div class="line"></div><div class="line">Series4_pdSeries = pd.Series( Series3_Dict ,<span class="built_in">index</span> = Series4_IndexList)</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series4_pdSeries</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series4_pdSeries.<span class="built_in">values</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> Series4_pdSeries.<span class="built_in">index</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> Series4_pdSeries.isnull()</div><div class="line"></div><div class="line"><span class="keyword">print</span> Series4_pdSeries.notnull()</div></pre></td></tr></table></figure>
<p>上面这样的输出就会按照<code>list</code>中定义的顺序输出结果。</p>
<blockquote>
<p>整个序列级别的元数据信息：name</p>
<p>当数据序列以及index本身有了名字，就可以更方便的进行后续的数据关联啦！</p>
</blockquote>
<p>这里我感觉就是列名的作用。下面举例：</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> Series4_pdSeries.<span class="keyword">name</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> Series4_pdSeries.<span class="built_in">index</span>.<span class="keyword">name</span></div></pre></td></tr></table></figure>
<p>很显然，输出的结果都是<code>None</code>，因为我们还没指定<code>name</code>嘛！</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series4_pdSeries<span class="selector-class">.name</span> = <span class="string">"Capital Series"</span></div><div class="line"></div><div class="line">Series4_pdSeries<span class="selector-class">.index</span><span class="selector-class">.name</span> = <span class="string">"Nation"</span></div><div class="line"></div><div class="line">print Series4_pdSeries</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Nation</div><div class="line"></div><div class="line">Japan Tokyo</div><div class="line"></div><div class="line">China Beijing</div><div class="line"></div><div class="line">Singapore NaN</div><div class="line"></div><div class="line">S.Korea Seoul</div><div class="line"></div><div class="line"><span class="keyword">Name</span>: Capital Series, dtype: <span class="keyword">object</span></div></pre></td></tr></table></figure>
<p>“字典”？不是的，⾏index可以重复，尽管不推荐。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Series5_IndexList = [<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>]</div><div class="line"></div><div class="line">Series5 = pd.Series(Series1.values,index = Series5_IndexList)</div><div class="line"></div><div class="line"><span class="built_in">print</span> Series5</div><div class="line"></div><div class="line"><span class="built_in">print</span> Series5<span class="string">[['B','A']]</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">A</span> <span class="number">0.030480</span></div><div class="line"></div><div class="line">B <span class="number">0.072746</span></div><div class="line"></div><div class="line">B -<span class="number">0.186607</span></div><div class="line"></div><div class="line">C -<span class="number">1.412244</span></div><div class="line"></div><div class="line">dtype: float64</div><div class="line"></div><div class="line">B <span class="number">0.072746</span></div><div class="line"></div><div class="line">B -<span class="number">0.186607</span></div><div class="line"></div><div class="line"><span class="keyword">A</span> <span class="number">0.030480</span></div><div class="line"></div><div class="line">dtype: float64</div></pre></td></tr></table></figure>
<p>我们可以看出，Series[‘B’]输出了两个值，所以index值尽量不要重复呀！</p>
<h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><p>DataFrame：pandas的战锤(数据表，⼆维数组)</p>
<p>Series的有序集合，就像R的DataFrame一样方便。</p>
<p>仔细想想，绝大部分的数据形式都可以表现为DataFrame。</p>
<h3 id="从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名"><a href="#从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名" class="headerlink" title="从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名"></a>从NumPy二维数组、从文件或者从数据库定义：数据虽好，勿忘列名</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dataNumPy = np.asarray([(<span class="string">'Japan'</span>,<span class="string">'Tokyo'</span>,<span class="number">4000</span>),(<span class="string">'S.Korea'</span>,<span class="string">'Seoul'</span>,<span class="number">1300</span>),(<span class="string">'China'</span>,<span class="string">'Beijing'</span>,<span class="number">9100</span>)])</div><div class="line"></div><div class="line"><span class="symbol">DF1</span> = pd.<span class="symbol">DataFrame</span>(dataNumPy,columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>])</div><div class="line"></div><div class="line"><span class="symbol">DF1</span></div></pre></td></tr></table></figure>
<p>这里DataFrame中的<code>columns</code>应该就是列名的意思。现在看<code>print</code>的结果，是不是很舒服啊！Excel的样式嘛</p>
<h3 id="等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的"><a href="#等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的" class="headerlink" title="等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的"></a>等长的列数据保存在一个字典里（JSON）：很不幸，字典key是无序的</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dataDict = &#123;<span class="string">'nation'</span>:[<span class="string">'Japan'</span>,<span class="string">'S.Korea'</span>,<span class="string">'China'</span>],<span class="string">'capital'</span>:[<span class="string">'Tokyo'</span>,<span class="string">'Seoul'</span>,<span class="string">'Beijing'</span>],<span class="string">'GDP'</span>:[<span class="number">4900</span>,<span class="number">1300</span>,<span class="number">9100</span>]&#125;</div><div class="line"></div><div class="line"><span class="symbol">DF2</span> = pd.<span class="symbol">DataFrame</span>(dataDict)</div><div class="line"></div><div class="line"><span class="symbol">DF2</span></div></pre></td></tr></table></figure>
<p>输出结果可以发现，<strong>无序的！</strong></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    GDP capital nation</div><div class="line"></div><div class="line"><span class="number">0</span>   <span class="number">4900</span>    Tokyo   Japan</div><div class="line"></div><div class="line"><span class="number">1</span>   <span class="number">1300</span>    Seoul   S.Korea</div><div class="line"></div><div class="line"><span class="number">2</span>   <span class="number">9100</span>    Beijing China</div></pre></td></tr></table></figure>
<p>PS:由于懒得截图放过来，这里没有了边框线。</p>
<h3 id="从另一个DataFrame定义DataFrame：啊，强迫症犯了！"><a href="#从另一个DataFrame定义DataFrame：啊，强迫症犯了！" class="headerlink" title="从另一个DataFrame定义DataFrame：啊，强迫症犯了！"></a>从另一个DataFrame定义DataFrame：啊，强迫症犯了！</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="attribute">DF21</span> = pd.DataFrame(DF2,columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>])</div><div class="line"></div><div class="line">DF21</div></pre></td></tr></table></figure>
<p>很明显，这里是利用<code>DF2</code>定义DF21，还通过指定<code>cloumns</code>改变了列名的顺序。</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="symbol">DF22</span> = pd.<span class="symbol">DataFrame</span>(<span class="symbol">DF2</span>,columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>],index = [<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>])</div><div class="line"></div><div class="line"><span class="symbol">DF22</span></div></pre></td></tr></table></figure>
<p>很明显，这里定义了<code>columns</code>的顺序，还定义了<code>index</code>的顺序。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">nation capital GDP</div><div class="line"></div><div class="line"><span class="number">2</span> China Beijing <span class="number">9100</span></div><div class="line"></div><div class="line"><span class="number">0</span> Japan Tokyo <span class="number">4900</span></div><div class="line"></div><div class="line"><span class="number">1</span> S.Korea Seoul <span class="number">1300</span></div></pre></td></tr></table></figure>
<h3 id="从DataFrame中取出列？两种方法（与JavaScript完全一致！）"><a href="#从DataFrame中取出列？两种方法（与JavaScript完全一致！）" class="headerlink" title="从DataFrame中取出列？两种方法（与JavaScript完全一致！）"></a>从DataFrame中取出列？两种方法（与JavaScript完全一致！）</h3><p>OMG，囧，我竟然都快忘了js语法了，现在想起了，但是对象的属性既可以<code>obj.x</code>也可以<code>obj[x]</code>。</p>
<ul>
<li><p>‘.’的写法容易与其他预留关键字产生冲突</p>
</li>
<li><p>‘[ ]’的写法最安全。</p>
</li>
</ul>
<h3 id="从DataFrame中取出行？（至少）两种⽅法："><a href="#从DataFrame中取出行？（至少）两种⽅法：" class="headerlink" title="从DataFrame中取出行？（至少）两种⽅法："></a>从DataFrame中取出行？（至少）两种⽅法：</h3><ul>
<li>方法1和方法2：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> DF22[0:1] <span class="comment">#给出的实际是DataFrame</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> DF22.ix[0] <span class="comment">#通过对应Index给出⾏,**ix**好爽。</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> nation  capital   GDP</div><div class="line"></div><div class="line"><span class="number">2</span>  China  Beijing  <span class="number">9100</span></div><div class="line"></div><div class="line">nation     Japan</div><div class="line"></div><div class="line">capital    Tokyo</div><div class="line"></div><div class="line">GDP         <span class="number">4900</span></div><div class="line"></div><div class="line"><span class="keyword">Name</span>: <span class="number">0</span>, dtype: <span class="keyword">object</span></div></pre></td></tr></table></figure>
<ul>
<li>方法3 <strong>像NumPy切片一样的终极招式：iloc </strong> ：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">print</span> DF22.iloc[0,:]    <span class="comment">#第一个参数是第几行，第二个参数是列。这里呢，就是第0行，全部列</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> DF22.iloc[:,0]    <span class="comment">#根据上面的描述，这里是全部行，第0列</span></div></pre></td></tr></table></figure>
<p>输出结果，验证一下：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">nation       China</div><div class="line"></div><div class="line">capital    Beijing</div><div class="line"></div><div class="line">GDP           <span class="number">9100</span></div><div class="line"></div><div class="line"><span class="keyword">Name</span>: <span class="number">2</span>, dtype: <span class="keyword">object</span></div><div class="line"></div><div class="line"><span class="number">2</span>      China</div><div class="line"></div><div class="line"><span class="number">0</span>      Japan</div><div class="line"></div><div class="line"><span class="number">1</span>    S.Korea</div><div class="line"></div><div class="line"><span class="keyword">Name</span>: nation, dtype: <span class="keyword">object</span></div></pre></td></tr></table></figure>
<h3 id="动态增加列列，但是无法用”-”的方式，只能用”-”"><a href="#动态增加列列，但是无法用”-”的方式，只能用”-”" class="headerlink" title="动态增加列列，但是无法用”.”的方式，只能用”[]”"></a>动态增加列列，但是无法用”.”的方式，只能用”[]”</h3><p>举个栗子说明一下就明白了：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DF22['population'] = [<span class="number">1600</span>,<span class="number">130</span>,<span class="number">55</span>]</div><div class="line"></div><div class="line">DF22</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">nation  capital GDP population</div><div class="line"></div><div class="line"><span class="number">2</span>   China   Beijing <span class="number">9100</span>    <span class="number">1600</span></div><div class="line"></div><div class="line"><span class="number">0</span>   Japan   Tokyo   <span class="number">4900</span>    <span class="number">130</span></div><div class="line"></div><div class="line"><span class="number">1</span>   S.Korea Seoul   <span class="number">1300</span>    <span class="number">55</span></div></pre></td></tr></table></figure>
<h2 id="Index：行级索引"><a href="#Index：行级索引" class="headerlink" title="Index：行级索引"></a>Index：行级索引</h2><p>Index：pandas进⾏数据操纵的鬼牌（行级索引）</p>
<p>⾏级索引是：</p>
<ul>
<li><p>元数据</p>
</li>
<li><p>可能由真实数据产生，因此可以视作数据</p>
</li>
<li><p>可以由多重索引也就是多个列组合而成</p>
</li>
<li><p>可以和列名进行交换，也可以进行堆叠和展开，达到Excel透视表效果</p>
</li>
</ul>
<p>Index有四种…哦不，很多种写法，⼀些重要的索引类型包括：</p>
<ul>
<li><p>pd.Index（普通）</p>
</li>
<li><p>Int64Index（数值型索引）</p>
</li>
<li><p>MultiIndex（多重索引，在数据操纵中更详细描述）</p>
</li>
<li><p>DatetimeIndex（以时间格式作为索引）</p>
</li>
<li><p>PeriodIndex （含周期的时间格式作为索引）</p>
</li>
</ul>
<h3 id="直接定义普通索引，长得就和普通的Series⼀样"><a href="#直接定义普通索引，长得就和普通的Series⼀样" class="headerlink" title="直接定义普通索引，长得就和普通的Series⼀样"></a>直接定义普通索引，长得就和普通的Series⼀样</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">index_names = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]</div><div class="line"></div><div class="line">Series_for_Index = pd.Series(index_names)</div><div class="line"></div><div class="line"><span class="built_in">print</span> pd.Index(index_names)</div><div class="line"></div><div class="line"><span class="built_in">print</span> pd.Index(Series_for_Index)</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Index([<span class="string">u'a'</span>, <span class="string">u'b'</span>, <span class="string">u'c'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'a'</span>, <span class="string">u'b'</span>, <span class="string">u'c'</span>], dtype=<span class="string">'object'</span>)</div></pre></td></tr></table></figure>
<p><strong>可惜Immutable，牢记！</strong>  不可变！举例如下：此处挖坑啊。不明白……</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">index_names = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>] </div><div class="line"></div><div class="line"><span class="keyword">index</span><span class="number">0</span> = pd.Index(index_names) </div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="keyword">index</span><span class="number">0</span>.get_values() </div><div class="line"></div><div class="line"><span class="keyword">index</span><span class="number">0</span>[<span class="number">2</span>] = <span class="string">'d'</span></div></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">['a' 'b' 'c']</div><div class="line"></div><div class="line"><span class="comment">---------------------------------------------------------------------------</span></div><div class="line"></div><div class="line">TypeError                                 Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>)</div><div class="line"></div><div class="line">&lt;ipython-<span class="keyword">input</span><span class="number">-36</span>-f34da0a8623c&gt; <span class="keyword">in</span> &lt;<span class="keyword">module</span>&gt;()</div><div class="line"></div><div class="line">      <span class="number">2</span> index0 = pd.Index(index_names)</div><div class="line"></div><div class="line">      <span class="number">3</span> print index0.get_values()</div><div class="line"></div><div class="line"><span class="comment">----&gt; 4 index0[2] = 'd'</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">C:\Anaconda\lib\site-packages\pandas\core\index.pyc <span class="keyword">in</span> __setitem__(<span class="keyword">self</span>, <span class="keyword">key</span>, <span class="keyword">value</span>)</div><div class="line"></div><div class="line">   <span class="number">1055</span> </div><div class="line"></div><div class="line">   <span class="number">1056</span>     <span class="keyword">def</span> __setitem__(<span class="keyword">self</span>, <span class="keyword">key</span>, <span class="keyword">value</span>):</div><div class="line"></div><div class="line">-&gt; <span class="number">1057</span>         <span class="keyword">raise</span> TypeError(<span class="string">"Indexes does not support mutable operations"</span>)</div><div class="line"></div><div class="line">   <span class="number">1058</span> </div><div class="line"></div><div class="line">   <span class="number">1059</span>     <span class="keyword">def</span> __getitem__(<span class="keyword">self</span>, <span class="keyword">key</span>):</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">TypeError: <span class="keyword">Indexes</span> does <span class="keyword">not</span> support mutable <span class="keyword">operations</span></div></pre></td></tr></table></figure>
<h3 id="扔进去一个含有多元组的List，就有了MultiIndex"><a href="#扔进去一个含有多元组的List，就有了MultiIndex" class="headerlink" title="扔进去一个含有多元组的List，就有了MultiIndex"></a>扔进去一个含有多元组的List，就有了MultiIndex</h3><p>可惜，如果这个List Comprehension改成小括号，就不对了。</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">multi1 = pd.Index([(<span class="string">'Row_'</span>+<span class="built_in">str</span>(x+<span class="number">1</span>),<span class="string">'Col_'</span>+<span class="built_in">str</span>(y+<span class="number">1</span>)) <span class="keyword">for</span> x <span class="built_in">in</span> xrange(<span class="number">4</span>) <span class="keyword">for</span> y <span class="built_in">in</span> xrange(<span class="number">4</span>)])</div><div class="line"></div><div class="line">multi1.<span class="built_in">name</span> = [<span class="string">'index1'</span>,<span class="string">'index2'</span>]</div><div class="line"></div><div class="line">print multi1</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">MultiIndex(levels=[[<span class="string">u'Row_1'</span>, <span class="string">u'Row_2'</span>, <span class="string">u'Row_3'</span>, <span class="string">u'Row_4'</span>], [<span class="string">u'Col_1'</span>, <span class="string">u'Col_2'</span>, <span class="string">u'Col_3'</span>, <span class="string">u'Col_4'</span>]],</div><div class="line"></div><div class="line">           labels=[[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>], [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</div></pre></td></tr></table></figure>
<h3 id="对于Series来说，如果拥有了多重Index，数据，变形！"><a href="#对于Series来说，如果拥有了多重Index，数据，变形！" class="headerlink" title="对于Series来说，如果拥有了多重Index，数据，变形！"></a>对于Series来说，如果拥有了多重Index，数据，变形！</h3><p>下列代码说明：</p>
<ul>
<li><p>二重MultiIndex的Series可以unstack()成DataFrame</p>
</li>
<li><p>DataFrame可以stack成拥有⼆重MultiIndex的Series</p>
</li>
</ul>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">data_for_mult<span class="keyword">i1</span> = pd.Series(xrange(<span class="number">0</span>,<span class="number">16</span>),index=mult<span class="keyword">i1</span>)</div><div class="line"></div><div class="line">data_for_mult<span class="keyword">i1</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">Row_1  Col_1     <span class="number">0</span></div><div class="line">       Col_2     <span class="number">1</span></div><div class="line"></div><div class="line">       Col_3     <span class="number">2</span></div><div class="line"></div><div class="line">       Col_4     <span class="number">3</span></div><div class="line">Row_2  Col_1     <span class="number">4</span></div><div class="line"></div><div class="line">       Col_2     <span class="number">5</span></div><div class="line"></div><div class="line">       Col_3     <span class="number">6</span></div><div class="line"></div><div class="line">       Col_4     <span class="number">7</span></div><div class="line">Row_3  Col_1     <span class="number">8</span></div><div class="line"></div><div class="line">       Col_2     <span class="number">9</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">10</span></div><div class="line"></div><div class="line">       Col_4    <span class="number">11</span></div><div class="line"></div><div class="line">Row_4  Col_1    <span class="number">12</span></div><div class="line">       Col_2    <span class="number">13</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">14</span></div><div class="line"></div><div class="line">       Col_4    <span class="number">15</span></div><div class="line"></div><div class="line"><span class="symbol">dtype:</span> int32</div></pre></td></tr></table></figure>
<p>看到输出结果，好像明白了点，有点类似Excel汇总一样。不过，日后还得查点<a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Index.html#pandas.Index" target="_blank" rel="external">资料</a></p>
<h4 id="二重MultiIndex的Series可以unstack-成DataFrame"><a href="#二重MultiIndex的Series可以unstack-成DataFrame" class="headerlink" title="二重MultiIndex的Series可以unstack()成DataFrame"></a>二重MultiIndex的Series可以unstack()成DataFrame</h4><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dat<span class="built_in">a_for</span>_multi1.unstack()</div></pre></td></tr></table></figure>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez8nly6izyj209w05b74r.jpg" alt="unstack结果"></p>
<h4 id="DataFrame可以stack成拥有⼆重MultiIndex的Series"><a href="#DataFrame可以stack成拥有⼆重MultiIndex的Series" class="headerlink" title="DataFrame可以stack成拥有⼆重MultiIndex的Series"></a>DataFrame可以stack成拥有⼆重MultiIndex的Series</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="selector-tag">data_for_multi1</span><span class="selector-class">.unstack</span>()<span class="selector-class">.stack</span>()</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Row_1  Col_1     <span class="number">0</span></div><div class="line"></div><div class="line">       Col_2     <span class="number">1</span></div><div class="line"></div><div class="line">       Col_3     <span class="number">2</span></div><div class="line"></div><div class="line">       Col_4     <span class="number">3</span></div><div class="line"></div><div class="line">Row_2  Col_1     <span class="number">4</span></div><div class="line"></div><div class="line">       Col_2     <span class="number">5</span></div><div class="line"></div><div class="line">       Col_3     <span class="number">6</span></div><div class="line"></div><div class="line">       Col_4     <span class="number">7</span></div><div class="line"></div><div class="line">Row_3  Col_1     <span class="number">8</span></div><div class="line"></div><div class="line">       Col_2     <span class="number">9</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">10</span></div><div class="line"></div><div class="line">       Col_4    <span class="number">11</span></div><div class="line"></div><div class="line">Row_4  Col_1    <span class="number">12</span></div><div class="line"></div><div class="line">       Col_2    <span class="number">13</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">14</span></div><div class="line"></div><div class="line">       Col_4    <span class="number">15</span></div><div class="line"></div><div class="line"><span class="symbol">dtype:</span> int32</div></pre></td></tr></table></figure>
<h3 id="非平衡数据的例子："><a href="#非平衡数据的例子：" class="headerlink" title="非平衡数据的例子："></a>非平衡数据的例子：</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">multi2 = pd.Index([(<span class="symbol">'Row_</span>'+<span class="built_in">str</span>(x+<span class="number">1</span>),<span class="symbol">'Col_</span>'+<span class="built_in">str</span>(y+<span class="number">1</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">5</span>) <span class="keyword">for</span> y <span class="keyword">in</span> xrange(x)])</div><div class="line"></div><div class="line">multi2</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">MultiIndex(levels=[[<span class="string">u'Row_2'</span>, <span class="string">u'Row_3'</span>, <span class="string">u'Row_4'</span>, <span class="string">u'Row_5'</span>], [<span class="string">u'Col_1'</span>, <span class="string">u'Col_2'</span>, <span class="string">u'Col_3'</span>, <span class="string">u'Col_4'</span>]],</div><div class="line"></div><div class="line">           labels=[[<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</div></pre></td></tr></table></figure>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">data_for_mult<span class="keyword">i2</span> = pd.Series(np.arange(<span class="number">10</span>),index = mult<span class="keyword">i2</span>) data_for_mult<span class="keyword">i2</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Row_2  Col_1    <span class="number">0</span></div><div class="line"></div><div class="line">Row_3  Col_1    <span class="number">1</span></div><div class="line"></div><div class="line">       Col_2    <span class="number">2</span></div><div class="line"></div><div class="line">Row_4  Col_1    <span class="number">3</span></div><div class="line"></div><div class="line">       Col_2    <span class="number">4</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">5</span></div><div class="line"></div><div class="line">Row_5  Col_1    <span class="number">6</span></div><div class="line"></div><div class="line">       Col_2    <span class="number">7</span></div><div class="line"></div><div class="line">       Col_3    <span class="number">8</span></div><div class="line"></div><div class="line">       Col_4    <span class="number">9</span></div><div class="line"></div><div class="line"><span class="symbol">dtype:</span> int32</div></pre></td></tr></table></figure>
<h3 id="DateTime标准库如此好⽤，你值得拥有"><a href="#DateTime标准库如此好⽤，你值得拥有" class="headerlink" title="DateTime标准库如此好⽤，你值得拥有"></a>DateTime标准库如此好⽤，你值得拥有</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import datetime</div><div class="line"></div><div class="line">dates = [datetime.datetime(<span class="number">2015</span>,<span class="number">1</span>,<span class="number">1</span>),datetime.datetime(<span class="number">2015</span>,<span class="number">1</span>,<span class="number">8</span>),datetime.datetime(<span class="number">2015</span>,<span class="number">1</span>,<span class="number">30</span>)]</div><div class="line"></div><div class="line">pd.DatetimeIndex(dates)</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DatetimeIndex(['<span class="number">2015</span><span class="number">-01</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-08</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-30</span>'], dtype='datetime64[ns]', freq=None, tz=None)</div></pre></td></tr></table></figure>
<h4 id="如果你不仅需要时间格式统一，时间频率也要统一的话"><a href="#如果你不仅需要时间格式统一，时间频率也要统一的话" class="headerlink" title="如果你不仅需要时间格式统一，时间频率也要统一的话"></a>如果你不仅需要时间格式统一，时间频率也要统一的话</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">periodindex1 = pd.period_range(<span class="string">'2015-01'</span>,<span class="string">'2015-04'</span>,freq=<span class="string">'M'</span>)</div><div class="line"></div><div class="line"><span class="built_in">print</span> periodindex1</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="title">PeriodIndex</span><span class="params">([<span class="string">'2015-01'</span>, <span class="string">'2015-02'</span>, <span class="string">'2015-03'</span>, <span class="string">'2015-04'</span>], dtype=<span class="string">'int64'</span>, freq=<span class="string">'M'</span>)</span></span></div></pre></td></tr></table></figure>
<h4 id="月级精度和日级精度如何转换？"><a href="#月级精度和日级精度如何转换？" class="headerlink" title="月级精度和日级精度如何转换？"></a>月级精度和日级精度如何转换？</h4><p>有的公司统⼀以1号代表当月，有的公司统一以最后1天代表当⽉，转化起来很麻烦，可以<code>asfreq</code></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">print</span> periodindex1.asfre<span class="string">q('D',how='start')</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> periodindex1.asfre<span class="string">q('D',how='end')</span></div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">PeriodIndex(['<span class="number">2015</span><span class="number">-01</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-04</span><span class="number">-01</span>'], dtype='int64', freq='D')</div><div class="line"></div><div class="line">PeriodIndex(['<span class="number">2015</span><span class="number">-01</span><span class="number">-31</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-28</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-31</span>', '<span class="number">2015</span><span class="number">-04</span><span class="number">-30</span>'], dtype='int64', freq='D')</div></pre></td></tr></table></figure>
<h4 id="最后的最后，我要真正把两种频率的时间精度匹配上？"><a href="#最后的最后，我要真正把两种频率的时间精度匹配上？" class="headerlink" title="最后的最后，我要真正把两种频率的时间精度匹配上？"></a>最后的最后，我要真正把两种频率的时间精度匹配上？</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">periodindex_mon = pd.period_range(<span class="string">'2015-01'</span>,<span class="string">'2015-03'</span>,freq=<span class="string">'M'</span>).asfre<span class="string">q('D',how='start')</span></div><div class="line"></div><div class="line">periodindex_day = pd.period_range(<span class="string">'2015-01-01'</span>,<span class="string">'2015-03-31'</span>,freq=<span class="string">'D'</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> periodindex_mon</div><div class="line"></div><div class="line"><span class="keyword">print</span> periodindex_day</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">PeriodIndex(['<span class="number">2015</span><span class="number">-01</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-01</span>'], dtype='int64', freq='D')</div><div class="line"></div><div class="line">PeriodIndex(['<span class="number">2015</span><span class="number">-01</span><span class="number">-01</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-02</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-03</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-04</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-05</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-06</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-07</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-08</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-09</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-10</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-11</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-12</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-13</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-14</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-15</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-16</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-17</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-18</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-19</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-20</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-21</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-22</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-23</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-24</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-25</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-26</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-27</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-28</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-01</span><span class="number">-29</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-30</span>', '<span class="number">2015</span><span class="number">-01</span><span class="number">-31</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-01</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-02</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-03</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-04</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-05</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-06</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-07</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-08</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-09</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-10</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-11</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-12</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-13</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-14</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-15</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-16</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-17</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-18</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-19</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-20</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-21</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-22</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-23</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-24</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-25</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-02</span><span class="number">-26</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-27</span>', '<span class="number">2015</span><span class="number">-02</span><span class="number">-28</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-01</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-02</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-03</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-04</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-05</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-06</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-07</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-08</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-09</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-10</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-11</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-12</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-13</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-14</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-15</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-16</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-17</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-18</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-19</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-20</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-21</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-22</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-23</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-24</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-25</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-26</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-27</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-28</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-29</span>',</div><div class="line"></div><div class="line">             '<span class="number">2015</span><span class="number">-03</span><span class="number">-30</span>', '<span class="number">2015</span><span class="number">-03</span><span class="number">-31</span>'],</div><div class="line"></div><div class="line">            dtype='int64', freq='D')</div></pre></td></tr></table></figure>
<h4 id="粗粒度数据＋reindex＋ffill-bfill"><a href="#粗粒度数据＋reindex＋ffill-bfill" class="headerlink" title="粗粒度数据＋reindex＋ffill/bfill"></a>粗粒度数据＋<code>reindex</code>＋<code>ffill/bfill</code></h4><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">full_ts = pd.Series(periodindex_mon,<span class="keyword">index</span>=periodindex_mon).reindex(periodindex_day,<span class="function"><span class="keyword">method</span>='<span class="title">ffill</span>')</span></div><div class="line"></div><div class="line"><span class="title">full_ts</span></div></pre></td></tr></table></figure>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez8obdrmi6j20ob0aqgn0.jpg" alt="粒度数据"></p>
<h3 id="关于索引，⽅便的操作有？"><a href="#关于索引，⽅便的操作有？" class="headerlink" title="关于索引，⽅便的操作有？"></a>关于索引，⽅便的操作有？</h3><p>前⾯描述过了，索引有序，重复，但⼀定程度上⼜能通过key来访问，也就是说，某些集合操作都是可以⽀持的。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">index1 = pd.Index([<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'C'</span>])</div><div class="line"></div><div class="line">index2 = pd.Index([<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'E'</span>,<span class="string">'E'</span>,<span class="string">'F'</span>])</div><div class="line"></div><div class="line">index3 = pd.Index([<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>])</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.append(index2)</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.difference(index2)</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.intersection(index2)</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.union(index2) <span class="comment"># Support unique-value Index well</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.isin(index2)</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.<span class="keyword">delete</span>(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.insert(<span class="number">0</span>,<span class="string">'K'</span>) <span class="comment"># Not suggested</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> index3.drop(<span class="string">'A'</span>) <span class="comment"># Support unique-value Index well</span></div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.is_monotonic,index2.is_monotonic,index3.is_monotonic</div><div class="line"></div><div class="line"><span class="built_in">print</span> index1.is_unique,index2.is_unique,index3.is_unique</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Index([<span class="string">u'A'</span>, <span class="string">u'B'</span>, <span class="string">u'B'</span>, <span class="string">u'C'</span>, <span class="string">u'C'</span>, <span class="string">u'C'</span>, <span class="string">u'D'</span>, <span class="string">u'E'</span>, <span class="string">u'E'</span>, <span class="string">u'F'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'A'</span>, <span class="string">u'B'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'C'</span>, <span class="string">u'C'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'A'</span>, <span class="string">u'B'</span>, <span class="string">u'B'</span>, <span class="string">u'C'</span>, <span class="string">u'C'</span>, <span class="string">u'D'</span>, <span class="string">u'E'</span>, <span class="string">u'E'</span>, <span class="string">u'F'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">[<span class="keyword">False</span> <span class="keyword">False</span> <span class="keyword">False</span>  <span class="keyword">True</span>  <span class="keyword">True</span>]</div><div class="line"></div><div class="line">Index([<span class="string">u'A'</span>, <span class="string">u'B'</span>, <span class="string">u'C'</span>, <span class="string">u'C'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'K'</span>, <span class="string">u'A'</span>, <span class="string">u'B'</span>, <span class="string">u'B'</span>, <span class="string">u'C'</span>, <span class="string">u'C'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">Index([<span class="string">u'B'</span>, <span class="string">u'C'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line"><span class="keyword">True</span> <span class="keyword">True</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="keyword">False</span> <span class="keyword">False</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
<h1 id="大熊猫世界来去自如：Pandas的I-O"><a href="#大熊猫世界来去自如：Pandas的I-O" class="headerlink" title="大熊猫世界来去自如：Pandas的I/O"></a>大熊猫世界来去自如：Pandas的I/O</h1><p>老生常谈，从基础来看，我们仍然关心pandas对于与外部数据是如何交互的。</p>
<h2 id="结构化数据输入输出"><a href="#结构化数据输入输出" class="headerlink" title="结构化数据输入输出"></a>结构化数据输入输出</h2><ul>
<li><p>read_csv与to_csv 是⼀对输⼊输出的⼯具，read_csv直接返回pandas.DataFrame，⽽to_csv只要执行命令即可写文件</p>
<ul>
<li><p>read_table：功能类似</p>
</li>
<li><p>read_fwf：操作fixed width file</p>
</li>
</ul>
</li>
<li><p>read_excel与to_excel方便的与excel交互</p>
</li>
<li><p>header 表⽰数据中是否存在列名，如果在第0行就写就写0，并且开始读数据时跳过相应的行数，不存在可以写none</p>
</li>
<li><p>names 表示要用给定的列名来作为最终的列名</p>
</li>
<li><p>encoding 表⽰数据集的字符编码，通常而言一份数据为了⽅便的进⾏⽂件传输都以utf-8作为标准</p>
</li>
</ul>
<p>这里用的是自己的一个<code>csv</code>数据，因为找不到参考的这个pdf中的数据。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">cnames=[<span class="string">'经度'</span>,<span class="string">'纬度'</span>]</div><div class="line"></div><div class="line">taxidata2 = pd.read_csv(<span class="string">'20140401.csv'</span>,<span class="selector-tag">header</span> = <span class="number">4</span>,names=cnames,encoding=<span class="string">'utf-8'</span>)</div><div class="line"></div><div class="line">taxidata2</div></pre></td></tr></table></figure>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9lm7fzejj20em09pq4t.jpg" alt="header=0"></p>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez9lmxnonvj20ix0a3jtj.jpg" alt="header=4"></p>
<p>全部参数的请移步API：</p>
<p><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html#pandas.read_csv" target="_blank" rel="external">http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html#pandas.read_csv</a></p>
<p>这里介绍一些常用的参数：</p>
<p>读取处理：</p>
<ul>
<li><p>skiprows：跳过⼀定的⾏数</p>
</li>
<li><p>nrows：仅读取⼀定的⾏数</p>
</li>
<li><p>skipfooter：尾部有固定的⾏数永不读取</p>
</li>
<li><p>skip_blank_lines：空⾏跳过</p>
</li>
</ul>
<p>内容处理：</p>
<ul>
<li><p>sep/delimiter：分隔符很重要，常⻅的有逗号，空格和Tab(‘\t’)</p>
</li>
<li><p>na_values：指定应该被当作na_values的数值</p>
</li>
<li><p>thousands：处理数值类型时，每千位分隔符并不统⼀ (1.234.567,89或者1,234,567.89都可能)，此时要把字符串转化为</p>
</li>
</ul>
<p>数字需要指明千位分隔符</p>
<p>收尾处理：</p>
<ul>
<li><p>index_col：将真实的某列（列的数⺫，甚⾄列名）当作index</p>
</li>
<li><p>squeeze：仅读到⼀列时，不再保存为pandas.DataFrame⽽是pandas.Series</p>
</li>
</ul>
<h2 id="Excel-…"><a href="#Excel-…" class="headerlink" title="Excel … ?"></a>Excel … ?</h2><p>对于存储着极为规整数据的Excel而言，其实是没必要一定用Excel来存，尽管Pandas也十分友好的提供了I/O接口。</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">taxidata.to_excel(<span class="string">'t0401.xlsx'</span>,<span class="keyword">encoding</span>=<span class="string">'utf-8'</span>)</div><div class="line"></div><div class="line">taxidata_from_excel = pd.read_excel(<span class="string">'t0401.xlsx'</span>,header=<span class="number">0</span>, <span class="keyword">encoding</span>=<span class="string">'utf-8'</span>)</div><div class="line"></div><div class="line">taxidata_from_excel</div></pre></td></tr></table></figure>
<p>注意：当你的xls文件行数很多超过65536时，就会遇到错误，解决办法是将写入的格式变为<code>xlsx</code>。<a href="http://stackoverflow.com/questions/17879805/xlwt-limiting-the-number-of-rows" target="_blank" rel="external">excel函数受限制问题</a></p>
<p>唯一重要的参数：sheetname=k，标志着一个excel的第k个sheet页将会被取出。（从0开始）</p>
<h2 id="半结构化数据"><a href="#半结构化数据" class="headerlink" title="半结构化数据"></a>半结构化数据</h2><p>JSON：网络传输中常⽤的⼀种数据格式。</p>
<p>仔细看一下，实际上这就是我们平时收集到异源数据的风格是一致的：</p>
<ul>
<li><p>列名不能完全匹配</p>
</li>
<li><p>key可能并不唯一</p>
</li>
<li><p>元数据被保存在数据里</p>
</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> json</div><div class="line"></div><div class="line">json_data = [&#123;<span class="string">'name'</span>:<span class="string">'Wang'</span>,<span class="string">'sal'</span>:<span class="number">50000</span>,<span class="string">'job'</span>:<span class="string">'VP'</span>&#125;,\</div><div class="line"></div><div class="line"> &#123;<span class="string">'name'</span>:<span class="string">'Zhang'</span>,<span class="string">'job'</span>:<span class="string">'Manager'</span>,<span class="string">'report'</span>:<span class="string">'VP'</span>&#125;,\</div><div class="line"></div><div class="line"> &#123;<span class="string">'name'</span>:<span class="string">'Li'</span>,<span class="string">'sal'</span>:<span class="number">5000</span>,<span class="string">'report'</span>:<span class="string">'IT'</span>&#125;]</div><div class="line"></div><div class="line">data_employee = pd.read_json(json.dumps(json_data))</div><div class="line"></div><div class="line">data_employee_ri = data_employee.reindex(columns=[<span class="string">'name'</span>,<span class="string">'job'</span>,<span class="string">'sal'</span>,<span class="string">'report'</span>])</div><div class="line"></div><div class="line">data_employee_ri</div></pre></td></tr></table></figure>
<p>输出结果：</p>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9mm97wqqj20if07egn7.jpg" alt=""></p>
<h1 id="深入Pandas数据操纵"><a href="#深入Pandas数据操纵" class="headerlink" title="深入Pandas数据操纵"></a>深入Pandas数据操纵</h1><p>在前面部分的基础上，数据会有更多种操纵方式：</p>
<ul>
<li><p>通过列名、行index来取数据，结合ix、iloc灵活的获取数据的一个子集（第一部分已经介绍）</p>
</li>
<li><p>按记录拼接（就像Union All）或者关联（join）</p>
</li>
<li><p>方便的统计函数与⾃定义函数映射</p>
</li>
<li><p>排序</p>
</li>
<li><p>缺失值处理</p>
</li>
<li><p>与Excel一样灵活的数据透视表（在第四部分更详细介绍）</p>
</li>
</ul>
<h2 id="数据集整合"><a href="#数据集整合" class="headerlink" title="数据集整合"></a>数据集整合</h2><h3 id="横向拼接：直接DataFrame"><a href="#横向拼接：直接DataFrame" class="headerlink" title="横向拼接：直接DataFrame"></a>横向拼接：直接DataFrame</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">pd.DataFrame([np<span class="selector-class">.random</span><span class="selector-class">.rand</span>(<span class="number">2</span>),np<span class="selector-class">.random</span><span class="selector-class">.rand</span>(<span class="number">2</span>),np<span class="selector-class">.random</span><span class="selector-class">.rand</span>(<span class="number">2</span>)],<span class="attribute">columns</span>=[<span class="string">'C1'</span>,<span class="string">'C2'</span>])</div></pre></td></tr></table></figure>
<h3 id="横向拼接：Concatenate"><a href="#横向拼接：Concatenate" class="headerlink" title="横向拼接：Concatenate"></a>横向拼接：Concatenate</h3><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">pd.concat([dat<span class="built_in">a_employee</span>_ri,dat<span class="built_in">a_employee</span>_ri,dat<span class="built_in">a_employee</span>_ri])</div></pre></td></tr></table></figure>
<p>输出结果</p>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez9mxf9uulj20he09pwg0.jpg" alt=""></p>
<h3 id="纵向拼接：Merge"><a href="#纵向拼接：Merge" class="headerlink" title="纵向拼接：Merge"></a>纵向拼接：Merge</h3><p>根据数据列关联，使用on关键字</p>
<ul>
<li><p>可以指定一列或多列</p>
</li>
<li><p>可以使⽤left_on和right_on</p>
</li>
</ul>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">pd.<span class="built_in">merge</span>(data_employee_ri,data_employee_ri,<span class="keyword">on</span>=<span class="string">'name'</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/6d9475f6jw1ez9mzcvkabj20g104dt9s.jpg" alt=""></p>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez9n2n6czpj20g904ejs9.jpg" alt=""></p>
<p>根据index关联，可以直接使用left_index和right_index</p>
<p>TIPS: 增加how关键字，并指定</p>
<ul>
<li><p>how = ‘inner’</p>
</li>
<li><p>how = ‘left’</p>
</li>
<li><p>how = ‘right’</p>
</li>
<li><p>how = ‘outer’</p>
</li>
</ul>
<p>结合how，可以看到merge基本再现了SQL应有的功能，并保持代码整洁</p>
<h2 id="自定义函数映射"><a href="#自定义函数映射" class="headerlink" title="自定义函数映射"></a>自定义函数映射</h2><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dataNumPy32 = np.asarray([(<span class="string">'Japan'</span>,<span class="string">'Tokyo'</span>,<span class="number">4000</span>),(<span class="string">'S.Korea'</span>,<span class="string">'Seoul'</span>,<span class="number">1300</span>),(<span class="string">'China'</span>,<span class="string">'Beijing'</span>,<span class="number">9100</span>)])</div><div class="line"></div><div class="line"><span class="symbol">DF32</span> = pd.<span class="symbol">DataFrame</span>(dataNumPy32,columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>])</div><div class="line"></div><div class="line"><span class="symbol">DF32</span></div></pre></td></tr></table></figure>
<p><img src="http://ww3.sinaimg.cn/large/6d9475f6jw1ez9nnizyfkj20lq05d0tu.jpg" alt=""></p>
<h3 id="map-以相同规则将1列数据作1个映射，也就是进行相同函数的处理"><a href="#map-以相同规则将1列数据作1个映射，也就是进行相同函数的处理" class="headerlink" title="map: 以相同规则将1列数据作1个映射，也就是进行相同函数的处理"></a>map: 以相同规则将1列数据作1个映射，也就是进行相同函数的处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">GDP_Factorize</span><span class="params">(v)</span>:</span></div><div class="line"></div><div class="line">    fv = np.float64(v)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> fv &gt; <span class="number">6000.0</span>:</div><div class="line"></div><div class="line">         <span class="keyword">return</span> <span class="string">'High'</span></div><div class="line"></div><div class="line">    <span class="keyword">elif</span> fv &lt; <span class="number">2000.0</span>:</div><div class="line"></div><div class="line">         <span class="keyword">return</span> <span class="string">'Low'</span></div><div class="line"></div><div class="line">    <span class="keyword">else</span>:</div><div class="line"></div><div class="line">         <span class="keyword">return</span> <span class="string">'Medium'</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">DF32[<span class="string">'GDP_Level'</span>] = DF32[<span class="string">'GDP'</span>].map(GDP_Factorize)</div><div class="line"></div><div class="line">DF32[<span class="string">'NATION'</span>] = DF32.nation.map(str.upper)</div><div class="line"></div><div class="line">DF32</div></pre></td></tr></table></figure>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9ns3fprvj20dy03ljs3.jpg" alt="map"></p>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><ul>
<li><p>sort: 按⼀列或者多列的值进行行级排序</p>
</li>
<li><p>sort_index: 根据index⾥的取值进行排序，而且可以根据axis决定是重排行还是列</p>
</li>
</ul>
<h3 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dataNumPy33 = np.asarray([(<span class="string">'Japan'</span>,<span class="string">'Tokyo'</span>,<span class="number">4000</span>),(<span class="string">'S.Korea'</span>,<span class="string">'Seoul'</span>,<span class="number">1300</span>),(<span class="string">'China'</span>,<span class="string">'Beijing'</span>,<span class="number">9100</span>)])</div><div class="line"></div><div class="line"><span class="symbol">DF33</span> = pd.<span class="symbol">DataFrame</span>(dataNumPy33,columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>])</div><div class="line"></div><div class="line"><span class="symbol">DF33</span></div></pre></td></tr></table></figure>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9o299de1j20nd05bgmp.jpg" alt=""></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DF33.<span class="keyword">sort</span>([<span class="string">'capital'</span>,<span class="string">'nation'</span>],ascending=<span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9o3xykzej20dj04et98.jpg" alt=""></p>
<p><code>ascending</code>是降序的意思。</p>
<h3 id="sort-index"><a href="#sort-index" class="headerlink" title="sort_index"></a>sort_index</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DF33.sort_index<span class="params">(<span class="attr">axis</span>=1,<span class="attr">ascending</span>=True)</span></div></pre></td></tr></table></figure>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9o77u4oej20de04jt97.jpg" alt=""></p>
<h3 id="一个好用的功能：Rank"><a href="#一个好用的功能：Rank" class="headerlink" title="一个好用的功能：Rank"></a>一个好用的功能：Rank</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="selector-tag">DF33</span><span class="selector-class">.rank</span>()</div></pre></td></tr></table></figure>
<p><img src="http://ww3.sinaimg.cn/large/6d9475f6jw1ez9oa7xelij20dx04k0sy.jpg" alt=""></p>
<h2 id="缺失数据处理"><a href="#缺失数据处理" class="headerlink" title="缺失数据处理"></a>缺失数据处理</h2><p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9oh1x2a8j20d209n3zp.jpg" alt=""></p>
<h3 id="忽略缺失值："><a href="#忽略缺失值：" class="headerlink" title="忽略缺失值："></a>忽略缺失值：</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DF34.mean(skipna=<span class="literal">True</span>)</div></pre></td></tr></table></figure>
<p>不忽略缺失值的话，估计就不能计算均值了吧。</p>
<p>如果不想忽略缺失值的话，就需要祭出fillna了：</p>
<p><img src="http://ww2.sinaimg.cn/large/6d9475f6jw1ez9ojdw89tj20f70dtwg4.jpg" alt=""></p>
<p>注：这里我在猜想，<code>axis=1</code>是不是就代表从<code>行</code>的角度呢？还是得多读书查资料呀。</p>
<h1 id="“一组”大熊猫：Pandas的groupby"><a href="#“一组”大熊猫：Pandas的groupby" class="headerlink" title="“一组”大熊猫：Pandas的groupby"></a>“一组”大熊猫：Pandas的groupby</h1><p>groupby的功能类似SQL的group by关键字：</p>
<p>Split-Apply-Combine</p>
<ul>
<li><p>Split，就是按照规则分组</p>
</li>
<li><p>Apply，通过⼀定的agg函数来获得输⼊pd.Series返回⼀个值的效果</p>
</li>
<li><p>Combine，把结果收集起来</p>
</li>
</ul>
<p>Pandas的groupby的灵活性：</p>
<ul>
<li><p>分组的关键字可以来⾃于index，也可以来⾃于真实的列数据</p>
</li>
<li><p>分组规则可以通过⼀列或者多列</p>
</li>
</ul>
<p>没有具体数据，截图看一下吧，方便日后回忆。</p>
<p><img src="http://ww4.sinaimg.cn/large/6d9475f6jw1ez9oqvhpvoj20lz0jggqk.jpg" alt=""></p>
<p>分组可以快速实现<code>MapReduce</code>的逻辑</p>
<ul>
<li><p>Map: 指定分组的列标签，不同的值就会被扔到不同的分组处理</p>
</li>
<li><p>Reduce: 输入多个值，返回1个值，一般可以通过agg实现，agg能接受1个函数</p>
</li>
</ul>
<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><ul>
<li><strong>S1EP3_Pandas.pdf</strong> 不知道什么时候存到电脑里的资料，今天发现了它。感谢作者的资料。</li>
</ul>
<hr>
<p>本文博客地址<a href="http://michaelxiang.me/2015/12/23/python-pandas-basic/" target="_blank" rel="external">Python数据分析入门之pandas总结基础</a><br>本文由 <strong><a href="http://michaelxiang.me/" target="_blank" rel="external">Michael翔</a></strong> 创作，采用 <strong><a href="http://creativecommons.org/licenses/by/3.0/cn/" target="_blank" rel="external">知识共享署名 3.0 中国大陆许可协议</a> </strong>进行许可。<br>可自由转载、引用，但需署名作者且注明文章出处。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    






    <!-- 使用 DISQUS_CLICK -->
    <div id="disqus-comment">
        <div id="disqus_thread"></div>

<!-- add animation -->
<style>
        .ripple-container {
        }
        .ripple-container .ripple{
            background-color: rgba(255,255,255,0.4);
            animation: ripple 2s forwards cubic-bezier(0, 0, 0.2, 1);
        }
        @keyframes ripple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            80% {
                transform: scale(1);
            }
            100% {
                opacity: 0;
            }
        }
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #757575;
            text-shadow: 0
        }
</style>
	
<!-- add data-ripple attribute -->
<div class="btn_click_load"> 
    <button class="disqus_click_btn">阅读评论 「请确保 disq.us &amp; disquscdn.com &amp; disqus.com 可以正常加载」</button>
</div>
	
<script>
    // add effect to elements
    Array.prototype.forEach.call(document.querySelectorAll('[data-ripple]'), function(element){
        // find all elements and attach effect
        new RippleEffect(element); // element is instance of javascript element node
    });
</script>

<script>
    var disqus_config = function () {
        this.page.url = 'http://michael728.github.io/2015/12/23/python-pandas-basic/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://michael728.github.io/2015/12/23/python-pandas-basic/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//michaelxiang.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
  	

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2015/12/20/life-20151220/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2015/12/24/algorithm-GA-basic/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/side_logo.jpg" alt="Michael_翔's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        http://michael728.github.io/
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: 649168982@qq.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/12/">十二月 2015<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">7</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">loyalty</i>
                
                标签
            </a>
        </li>
        
    
        <li>
            <a href="/tools" title="工具">
                
                    <i class="material-icons sidebar-material-icons">build</i>
                
                工具
            </a>
        </li>
        
    
        <li>
            <a href="/gallery" title="足迹">
                
                    <i class="material-icons sidebar-material-icons">camera</i>
                
                足迹
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友链">
                
                    <i class="material-icons sidebar-material-icons">group</i>
                
                友链
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">26</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/Michael_Xiang_" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.svg);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/xiangzai728/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.svg);">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/michaelXoX/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-zhihu.svg);">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;Michael翔的小窝
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize('7CDtrbb4U7nQzOdctmXXnMqt-gzGzoHsz', 'ISgUUtg79U9Eq0ActHmVRtmN');
    </script>
    <script>
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>




    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>










<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
